<!DOCTYPE html>
<html>
  <!-- Page Data -->
  <head>
    <title>Coaster Rankings</title>
    <link rel="stylesheet" type="text/css" href="mainpage.css">
    <link rel="stylesheet" type="text/css" href="rankings.css">
    <link rel="icon" type="image/x-icon" href="/images/Favicon.png">
  </head>
  <body>
    <!-- Header -->
    <div class="header" style="margin:0;">
      <!-- <h1 class="headertitle" style="margin:0;">Jake's Roller Coasters</h1>-->
      <img src="/images/RCITitle.png" alt="Roller.Coaster.Images" class="center">
    </div>
  
    <!-- Navigation Bar -->
    <div class="topnav" id="myTopnav" style="margin:0;">
      <a href="https://watkin81.github.io/index.html">Home</a>
      <a href="https://watkin81.github.io/rankings.html">Rankings and Data</a>
      <a href="https://watkin81.github.io/index.html">Coaster Images</a>
      <a href="https://www.instagram.com/roller.coaster.images/" target="_blank" rel="noopener noreferrer">Roller.Coaster.Images Instagram</a>
      <a href="https://docs.google.com/spreadsheets/d/1t3_wkdWKvjc4ShfH19wA3XxdOACtt6-elpsVk1Y9krs" target="_blank" rel="noopener noreferrer">The Official Coaster Nerd Spreadsheet</a>
      <a href="https://docs.google.com/document/d/1R9gMBCIvhuTBLrbh60jCBUDpgeWp7a6Lxy510fxzx-g" target="_blank" rel="noopener noreferrer">Coaster List Document</a>
    </div>
    
    <p> THIS PAGE IS VERY VERY UNDER CONSTRUCTION AND VERY VERY BUGGY!!! | version: 15<p>
    <label>Sort Manu:</label>
      <select id="selectManu">
        <option value="">All Manufacturers</option>
        <option value="arrow">Arrow Dynamics</option>
        <option value="art engineering">ART Engineering</option>
        <option value="b&m">Bolliger & Mabillard</option>
        <option value="cci">Custom Coasters International</option>
        <option value="chance rides">Chance Rides</option>
        <option value="cobb & associates">Cobb & Associates</option>
        <option value="dh morgan">D.H. Morgan Manufacturing</option>
        <option value="dinn">Dinn Corporation</option>
        <option value="dynamic attractions">Dynamic Attractions</option>
        <option value="e&f miler">E&F Miler Industries</option>
        <option value="gci">Great Coasters International</option>
        <option value="gerstlauer">Gerstlauer</option>
        <option value="giovanola">Giovanola</option>
        <option value="gravity group">Gravity Group</option>
        
      </select>
    
    <input type="text" id="coasterInput" placeholder="ðŸ”Žï¸Ž Search for a coaster or park..." margin-left:auto;margin-right:auto;>
    
    <br>
    <p id="coasternames"></p>
    <div id="coasterTableDiv">
    </div>
    
    <!--  onkeyup="searchFunction()"  onchange="searchManuFunction()"   <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>-->
    <script type="text/javascript" src="https://unpkg.com/papaparse@5.3.2/papaparse.min.js" integrity="sha384-6kRQDsV2kVYRSENnw7WnekWKCx8/Lmv7rFKpDuR2AoIbjlBShlYcs3x0QlE3kuRh" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1t3_wkdWKvjc4ShfH19wA3XxdOACtt6-elpsVk1Y9krs/pub?output=csv';

      function init() {
        Papa.parse(public_spreadsheet_url, {
          download: true,
          header: true,
          complete: makeTable
        })
      }

      window.addEventListener('DOMContentLoaded', init)
      
      function makeTable(results) {
        var data = results.data
        const newTable = document.createElement("table");
        newTable.innerHTML = '<thead><th onclick="sortTable(0)">Rank</th><th onclick="sortTable(1)">Coaster</th><th onclick="sortTable(2)">Park</th><th onclick="sortTable(3)">Manufacturer</th></thead>';
        var j = 0;
        while (j < data.length){
          const newRow = document.createElement("tr");
          const tdRank = document.createElement("td");
          const tdCoaster = document.createElement("td");
          const tdPark = document.createElement("td");
          const tdManu = document.createElement("td");
          tdRank.textContent = data[j].RANK;
          tdCoaster.textContent = data[j].COASTER;
          tdPark.textContent = data[j].PARK;    
          tdManu.textContent = data[j].MANUFACTURER;
          newRow.appendChild(tdRank);
          newRow.appendChild(tdCoaster);
          newRow.appendChild(tdPark);
          newRow.appendChild(tdManu);
          newTable.appendChild(newRow);
          j++;
        }

        const coasterTable = document.getElementById('coasterTableDiv');
        coasterTable.appendChild(newTable);
        coasterTable.setAttribute("id", "coasterTable");
      }
     
      document.write("spreadsheet link: <a target='_new' href='" + public_spreadsheet_url + "'>" + public_spreadsheet_url + "</a>");        
 /*
      function searchManuFunction() {
        // Declare variables
        var input, filter, searchTable, tr, td3, i, txtValue;
        input = document.getElementById("selectManu");
        filter = input.value.toUpperCase();
        searchTable = document.getElementById("coasterTable");
        tr = searchTable.getElementsByTagName("tr");

        // Loop through all table rows, and hide those who don't match the search query
        if (filter != "") {
        for (i = 0; i < tr.length; i++) {
          td3 = tr[i].getElementsByTagName("td")[3];
          if (td3) {
            txtValue3 = (td3.textContent || td3.innerText);
            if (txtValue3.toUpperCase().indexOf(filter) > -1) {
              tr[i].style.display = "";
            } else {
              tr[i].style.display = "none";
            }
          }
          }
        }
      }
      
      function searchFunction() {
        // Declare variables
        var input, filter, searchTable, tr, td1, td2, i, txtValue, inputdropdown, filterdropdown;
        input = document.getElementById("coasterInput");
        filter = input.value.toUpperCase();
        searchTable = document.getElementById("coasterTable");
        tr = searchTable.getElementsByTagName("tr");
        inputdropdown = document.getElementById("selectManu");
        filterdropdown = inputdropdown.value.toUpperCase();

        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
          td1 = tr[i].getElementsByTagName("td")[1];
          td2 = tr[i].getElementsByTagName("td")[2];
          td3 = tr[i].getElementsByTagName("td")[3];
          if (td1 || td2) {
            txtValue1 = (td1.textContent || td1.innerText);
            txtValue2 = (td2.textContent || td2.innerText);
            if (((txtValue1.toUpperCase().indexOf(filter) > -1) || (txtValue2.toUpperCase().indexOf(filter) > -1)) && (td3 != filterdropdown)) {
              tr[i].style.display = "";
            } else {
              tr[i].style.display = "none";
            }
          }
        }
      } */
      
  function filterTable() {
  var input, filter, table, tr, td, te, i, txtValue, txtValue2, select;
  input = document.getElementById("coasterInput");
  filter = input.value.toUpperCase();
  select = document.getElementById("selectManu");
  selectedOption = select.options[select.selectedIndex].value.toUpperCase();
  table = document.getElementById("coasterTable");
  tr = table.getElementsByTagName("tr");

  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[1]; //coaster name
    te = tr[i].getElementsByTagName("td")[2]; //park name
    if (td || te) {
      txtValue = td.textContent || td.innerText;
      txtValue2 = te.textContent || te.innerText;
      if ((txtValue.toUpperCase().indexOf(filter) > -1 || txtValue2.toUpperCase().indexOf(filter) > -1) && (selectedOption === "ALL MANUFACTURERS" || tr[i].getElementsByTagName("td")[3].textContent.toUpperCase().indexOf(selectedOption) > -1)) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}

// Event listener for the input and select elements
document.getElementById("coasterInput").addEventListener("keyup", filterTable);
document.getElementById("selectManu").addEventListener("change", filterTable);

      
    </script> 
  </body>
</html>
